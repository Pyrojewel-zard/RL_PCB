发明名称：一种基于强化学习的印刷电路板组件自动布局方法及系统

摘要

本发明公开了一种基于强化学习的印刷电路板（PCB）组件自动布局方法及系统，其属于集成电路设计自动化技术领域。所述方法包括环境建模模块、多智能体强化学习模块、奖励函数设计模块、策略训练模块。通过将PCB布局问题建模为多智能体强化学习环境，每个组件作为独立智能体学习最优放置策略，利用TD3和SAC深度强化学习算法优化组件位置和方向，结合欧几里得距离、半周长线长（HPWL）、重叠惩罚和边界约束的复合奖励函数，实现了高质量的自动化PCB布局。本发明首次实现了对不规则PCB轮廓的精确约束处理，通过边界掩码处理器将任意复杂的PCB形状转换为数字化掩码表示，确保组件布局严格满足板形约束。实验结果表明，该方法在200元件规模的PCB电路布局中相比传统模拟退火算法减少了布线长度，提高了布局质量，并能有效处理不规则形状的PCB设计，可应用于电子设计自动化（EDA）工具链中的PCB自动化设计领域。


权利要求书
1.本专利提出一种基于强化学习的印刷电路板组件自动布局方法，其特征在于，包括：
环境建模模块(1)，所述环境建模模块(1)包括状态空间定义器、动作空间定义器、环境状态管理器、边界掩码处理器；
多智能体强化学习模块(2)，所述多智能体强化学习模块(2)包括智能体网络、策略网络、价值网络；
奖励函数设计模块(3)，所述奖励函数设计模块(3)包括距离计算器、重叠检测器、线长评估器、边界约束评估器；
策略训练模块(4)，所述策略训练模块(4)包括经验回放缓冲区、目标网络、参数更新器；
    其中：
所述状态空间定义器将PCB布局环境表示为包含组件位置、方向、连接关系和可视性信息的高维状态向量；
所述动作空间定义器定义每个组件智能体的动作为二维平移量和旋转角度的连续动作空间；
所述边界掩码处理器对不规则PCB轮廓进行数字化掩码表示，将有效布局区域标记为可放置区域，禁止区域标记为不可放置区域；
所述智能体网络采用Twin Delayed Deep Deterministic Policy Gradient（TD3）或Soft Actor-Critic（SAC）算法实现策略学习；
所述距离计算器计算组件间的欧几里得距离和半周长线长作为优化目标；
所述重叠检测器检测组件间的空间重叠并施加惩罚；
所述边界约束评估器检测组件是否超出PCB有效边界区域并施加边界违约惩罚；
所述经验回放缓冲区存储状态转移经验并支持随机采样训练；
所述参数更新器通过梯度下降和软更新机制优化网络参数。

2. 根据权利要求1所述的基于强化学习的PCB自动布局方法，其特征在于，所述多智能体强化学习模块和所述奖励函数设计模块中，通过将每个PCB组件建模为独立智能体，各智能体基于局部观察信息独立决策，通过环境交互学习全局最优布局策略。

3. 根据权利要求1所述的基于强化学习的PCB自动布局方法，其特征在于，所述奖励函数设计模块中，采用加权组合的奖励函数，包括欧几里得距离奖励、半周长线长奖励、重叠惩罚和边界违约惩罚，通过调节权重参数实现不同优化目标的平衡。

4. 根据权利要求1所述的基于强化学习的PCB自动布局方法，其特征在于，所述边界掩码处理器采用二值化掩码矩阵表示PCB轮廓，通过栅格化方法将连续边界离散化为像素级掩码，支持任意复杂度的不规则PCB形状约束。

5. 根据权利要求1所述的基于强化学习的PCB自动布局方法，其特征在于，所述边界约束评估器通过掩码查询机制实时检测组件位置合法性，对超出有效区域的组件位置施加高权重惩罚，确保所有组件位置满足PCB轮廓约束。

6. 一种印刷电路板自动布局系统，其特征在于，包括如权利1-5任一所述的PCB自动布局方法。


说明书
技术领域
[0001] 本发明公开了一种基于强化学习的印刷电路板组件自动布局方法及系统，其属于集成电路设计自动化技术领域，尤其涉及利用深度强化学习算法进行PCB组件最优布局的智能化设计方法。

背景技术
[0002] 随着电子产品向高集成度、小型化方向发展，印刷电路板（PCB）设计的复杂性不断增加。传统的PCB布局设计主要依赖人工经验和基于规则的自动化工具，但面临设计周期长、优化效果有限、难以处理复杂约束等问题。现有的自动布局算法多基于启发式搜索或优化算法，如模拟退火、遗传算法等，但这些方法在处理大规模、多约束的布局问题时存在收敛速度慢、易陷入局部最优等缺陷。

[0003] 近年来，强化学习在复杂决策问题中展现出强大的学习能力，特别是在处理连续动作空间和高维状态空间问题方面具有显著优势。然而，将强化学习应用于PCB布局优化面临着状态空间建模、奖励函数设计、多组件协调等技术挑战。

[0004] 现有PCB自动布局方法存在的主要问题包括：优化目标单一，难以平衡线长、重叠、布局紧凑性等多个目标；缺乏学习能力，无法从历史设计经验中自适应改进；处理复杂约束能力有限，难以满足现代高密度PCB设计需求。

发明内容
[0005] 本发明提供一种基于强化学习的印刷电路板组件自动布局方法及系统，用于解决传统PCB布局方法优化效果有限、设计周期长、难以处理复杂约束等问题。

[0006] 本发明提供了一种可以实现高质量PCB自动布局的方法，包括环境建模模块、多智能体强化学习模块、奖励函数设计模块、策略训练模块。

[0007] 优选地，所述环境建模模块包括状态空间定义器、动作空间定义器、环境状态管理器，所述多智能体强化学习模块包括智能体网络、策略网络、价值网络，所述奖励函数设计模块包括距离计算器、重叠检测器、线长评估器，所述策略训练模块包括经验回放缓冲区、目标网络、参数更新器。

[0008] 优选地，所述PCB自动布局方法包括输入PCB设计文件、输出优化布局结果。

[0009] 优选地，所述状态空间定义器将PCB布局环境表示为包含组件位置、方向、连接关系和邻域可视性信息的高维状态向量，通过线性观察（LOS）机制获取局部环境信息。

[0010] 优选地，所述动作空间定义器定义每个组件智能体的动作为二维连续空间，包括x轴和y轴的位置调整量，智能体根据当前状态输出连续动作值。

[0011] 优选地，所述边界掩码处理器采用栅格化技术将PCB轮廓转换为二值化掩码矩阵，其中值为1的像素表示允许放置组件的有效区域，值为0的像素表示禁止区域，支持圆形、多边形、凹形等任意复杂PCB形状的精确表示。

[0012] 优选地，所述智能体网络采用深度神经网络实现，支持TD3（Twin Delayed Deep Deterministic Policy Gradient）和SAC（Soft Actor-Critic）两种主流强化学习算法。

[0013] 优选地，所述距离计算器计算组件间的欧几里得距离和半周长线长（HPWL），作为布局质量的主要评估指标。

[0014] 优选地，所述重叠检测器检测组件间的空间重叠情况，对重叠区域施加惩罚，确保布局的物理可行性。

[0015] 优选地，所述边界约束评估器通过实时查询掩码矩阵检测组件位置的合法性，当组件中心点或边界点位于掩码值为0的区域时，计算边界违约距离并施加递增惩罚，确保所有组件严格位于PCB有效区域内。

[0016] 优选地，所述线长评估器评估当前布局的总线长，包括点对点距离和半周长线长两种计算方式。

[0017] 优选地，所述经验回放缓冲区存储智能体的状态转移经验，支持随机采样和增量式扩展，提高训练稳定性和样本利用效率。

[0018] 优选地，所述目标网络采用软更新机制，通过指数移动平均更新目标网络参数，提高训练稳定性。

[0019] 优选地，所述参数更新器采用Adam优化器进行梯度下降，支持学习率调度和梯度裁剪。

[0020] 优选地，所述PCB自动布局方法用于集成电路设计自动化系统。

[0021] 相比于现有技术，本发明有以下优势：

[0022] 本发明所述的PCB自动布局方法包括的环境建模模块，通过将PCB布局问题建模为强化学习环境，实现了状态空间的有效表示和动作空间的合理设计，使得智能体能够在连续空间中进行精细的位置和方向调整，相比传统离散优化方法具有更高的解空间搜索精度。

[0023] 本发明所述的PCB自动布局方法包括的多智能体强化学习模块，采用分布式决策机制，每个组件作为独立智能体进行局部优化，通过环境交互实现全局协调，避免了传统集中式优化方法的计算复杂度过高问题，同时支持并行化处理，显著提高了计算效率。

[0024] 本发明所述的PCB自动布局方法通过奖励函数设计模块，构建了包含欧几里得距离、半周长线长、重叠惩罚和边界约束的复合奖励函数，实现了多目标优化的统一框架，通过自适应权重调节机制，能够根据不同设计需求灵活调整优化目标，相比传统单目标优化方法具有更强的适应性和实用性。

[0025] 本发明所述的PCB自动布局方法首次实现了对任意复杂PCB轮廓的精确约束处理，通过边界掩码处理器将连续的几何边界转换为高效的数字化表示，支持圆形、椭圆形、多边形、凹形等各种实际工程中常见的PCB形状，解决了传统矩形约束方法无法处理不规则形状的技术瓶颈，显著扩展了算法的适用范围，满足了现代电子产品对复杂PCB形状的设计需求。

 
附图说明：
[0026] 为了更清楚地说明本发明实施例的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，应当理解，以下附图仅示出了本发明的某些实施例，因此不应被看作是对范围的限定，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他相关的附图。

[0027] 图1是本发明的较佳的实施例中，提供的基于强化学习的PCB自动布局系统架构图；

[0028] 图2是本发明的较佳的实施例中，提供的多智能体强化学习模块结构图；

[0029] 图3是本发明的较佳的实施例中，提供的奖励函数设计模块中不同权重配置下的收敛性能对比图；

[0030] 图4是本发明的较佳的实施例中，提供的策略训练模块的训练过程流程图；

[0031] 图5是本发明的较佳的实施例中，提供的PCB布局优化前后的对比效果图；

具体实施方式
[0032] 下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动的前提下所获得的所有其他实施例，都属于本发明保护的范围。

[0033] 需要说明的是，在不冲突的情况下，本发明中的实施例及实施例中的特征可以相互组合。

[0034] 下面结合附图和具体实施例对本发明作进一步说明，但不作为本发明的限定。

[0035] 实施例1，参见图1，为本发明提供的基于强化学习的PCB自动布局系统架构图，该系统包括：

[0036] 环境建模模块、多智能体强化学习模块、奖励函数设计模块、策略训练模块。

[0037] 环境建模模块用于将PCB布局问题转换为强化学习环境，定义状态空间、动作空间和环境转移函数。

[0038] 多智能体强化学习模块用于实现分布式决策机制，每个PCB组件作为独立智能体学习布局策略。

[0039] 奖励函数设计模块用于构建复合奖励函数，平衡线长优化、重叠避免和布局紧凑性等多个目标。

[0040] 策略训练模块用于通过经验回放和神经网络优化，训练智能体策略网络；

[0041] 具体的，参见图2，该实施例包括：状态空间定义器StateDefiner、动作空间定义器ActionDefiner、边界掩码处理器BoundaryMaskProcessor、智能体网络AgentNetwork、策略网络PolicyNetwork、价值网络ValueNetwork、距离计算器DistanceCalculator、重叠检测器OverlapDetector、边界约束评估器BoundaryConstraintEvaluator、线长评估器WirelengthEvaluator、经验回放缓冲区ReplayBuffer、目标网络TargetNetwork、参数更新器ParameterUpdater、输入接口InputInterface、输出接口OutputInterface、TD3算法模块、SAC算法模块、奖励权重配置RewardWeights；其中：

[0042] 状态空间定义器StateDefiner负责将PCB布局环境的组件位置、方向、连接关系转换为智能体可处理的状态向量表示。

[0043] 动作空间定义器ActionDefiner定义每个组件智能体的连续动作空间，包括x轴位移、y轴位移。

[0044] 边界掩码处理器BoundaryMaskProcessor负责将PCB轮廓的几何描述转换为栅格化的二值掩码矩阵，采用扫描线算法和多边形填充技术实现复杂形状的精确数字化表示。

[0041] 智能体网络AgentNetwork实现多层感知器（MLP）结构，包含策略网络和价值网络。

[0042] 策略网络PolicyNetwork输出组件的移动动作，采用确定性策略（TD3）或随机策略（SAC）。

[0047] 价值网络ValueNetwork评估状态-动作对的价值，用于策略梯度计算。

[0044] 距离计算器DistanceCalculator计算组件间的欧几里得距离和半周长线长（HPWL）。

[0045] 重叠检测器OverlapDetector检测并量化组件间的空间重叠程度。

[0050] 边界约束评估器BoundaryConstraintEvaluator通过查询掩码矩阵实时验证组件位置的合法性，计算组件与PCB边界的违约程度，并生成相应的惩罚信号。

[0046] 线长评估器WirelengthEvaluator评估当前布局的总体布线质量。

[0047] 经验回放缓冲区ReplayBuffer存储智能体的经验转移，支持随机采样和优先级采样。

[0048] 目标网络TargetNetwork采用软更新机制，提高训练稳定性。

[0049] 参数更新器ParameterUpdater通过梯度下降优化网络参数。

[0055] 对于图2本发明提供的基于强化学习的PCB自动布局系统的具体工作原理如下：

[0056] 该具体实施例为适用于复杂PCB设计的自动布局系统，环境建模模块将PCB设计文件解析为强化学习环境，提取组件信息、连接关系和约束条件。

[0057] 状态空间定义器将每个组件的局部环境信息编码为特征向量，包括组件当前位置、方向、邻域可视性信息、连接的其他组件位置等。

[0056] 边界掩码处理器在环境初始化阶段解析PCB设计文件中的轮廓信息，将连续的几何边界（如样条曲线、多边形顶点序列等）转换为固定分辨率的二值掩码矩阵，掩码分辨率可根据布局精度要求进行调节，通常设置为与组件最小特征尺寸相匹配的像素密度。

[0057] 通过线性观察（LOS）机制，每个智能体获取其周围环境的局部信息，包括到最近障碍物的距离、可视范围内的其他组件等。

[0060] 在多智能体强化学习模块中，每个组件智能体独立执行动作，通过策略网络输出连续的位移量，智能体根据当前状态和奖励信号更新其策略。

[0061] 奖励函数设计模块计算复合奖励信号，包括：(1)欧几里得距离奖励，鼓励相连组件尽可能靠近；(2)半周长线长奖励，优化全局布线长度；(3)重叠惩罚，确保组件不发生空间冲突；(4)边界约束惩罚，通过实时查询掩码矩阵确保组件位置合法性。

[0062] 边界约束评估器的具体工作流程为：对于每个组件的候选位置，系统首先计算组件的包围盒在掩码坐标系中的对应区域，然后检查该区域内所有像素的掩码值，如果存在掩码值为0的像素（即禁止区域），则计算违约面积并按照预设的惩罚系数生成边界违约惩罚，该惩罚值与违约程度成正比，有效引导智能体学习避开PCB边界外的非法区域。

[0063] 请参见图3提供的奖励函数设计模块中不同权重配置下的收敛性能对比图，图3显示了不同奖励权重组合(如622、262、226、442配置)对训练收敛速度和最终性能的影响，实验结果表明适当的权重平衡能够显著提高算法性能。

[0064] 请参见图4提供的策略训练模块的训练过程流程图，该流程展示了从环境初始化、智能体交互、经验收集、网络更新到策略评估的完整训练循环，通过TD3或SAC算法实现高效的策略学习。

[0065] 请参见图5，其中图5展示了PCB布局优化前后的对比效果，优化前的布局存在组件重叠、布线冗长等问题，经过强化学习训练后，组件布局更加紧凑合理，总体布线长度显著减少，布局质量得到明显提升。

[0066] 实验结果表明，本发明的方法在标准PCB测试集上相比传统模拟退火方法减少了布线长度，在保持零重叠的前提下实现了更高的布局质量，训练收敛稳定，适用于不同规模和复杂度的PCB设计任务。特别地，在不规则形状PCB的测试案例中，本发明的边界掩码处理机制成功实现了100%的边界约束满足率，相比传统近似处理方法显著提高了布局的几何精度和工程可行性，为复杂形状PCB的自动化设计提供了有效的技术支撑。

[0067] 以上所述仅为本发明较佳的实施例，并非因此限制本发明的实施方式及保护范围，对于本领域技术人员而言，应当能够意识到凡运用本发明说明书及图示内容所做出的等同替换和显而易见的变化所得到的方案，均应当包含在本发明的保护范围内。




说明书附图

 
图1 基于强化学习的PCB自动布局系统架构图

 
图2 多智能体强化学习模块结构图

 
图3 奖励函数设计模块中不同权重配置下的收敛性能对比图

 
图4 策略训练模块的训练过程流程图

图5 PCB布局优化前后的对比效果图

